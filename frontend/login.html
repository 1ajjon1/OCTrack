<!DOCTYPE html>
<html lang="en">
    <head>
        <meta name="authors" content="Saravanan Rajeswaran; DJ Watson; Taleiven Goundan; Justin Le">
        <link rel="stylesheet" type="text/css" href="Stylesheet/Stylesheet_A1.css">
        <link rel="preconnect" href="https://rsms.me/">
        <link rel="stylesheet" href="https://rsms.me/inter/inter.css">
        <style>
             @font-face {
                font-family: Inter;
                src: url(fonts/Inter/Inter-Italic-VariableFont_opsz\,wght.ttf);
             }
            @font-face {
                font-family: Inter;
                src: url(fonts/Inter/static/Inter_18pt-Light.ttf);
            }
            @font-face {
                font-family: Inter;
                src: url(fonts/Inter/static/Inter_24pt-Light.ttf);
            }
            @font-face {
                font-family: Inter-28pt;
                src: url(fonts/Inter/static/Inter_28pt-Light.ttf);
            }
            
        </style>
    </head>
    <title>OCTrack - Home</title>
    <body>
        

        <section>
            <img src="images/OC_Transpo_A1.jpg" class="layer-1">
            <div class="Rectangle"></div>
            <div class="physical-container"> 
                <h2>Client Registration</h2>
                <p>To book a trip with us, please register using your email.</p>   
                <p>Email: <input id="emailRegistration"></p>
                <p>Name: <input id="nameRegistration"></p>
                <p>Username: <input id="userRegistration"></p>
                <p>Password: <input id="passwordRegistration"></p>
                <p>Confirm password: <input id="passwordConfirmation"></p>
                
                <p id="regMsg"><br></p>
                <button id="registrationButton">Register</button>
            </div>

            <div class="physical-container" style="margin-left: 42%;">
                <h2>Login</h2>
                <p>Email: <input id="loginEmail"></p>
                <p>Password: <input id="loginPassword" type="password"></p>
                <button id="loginButton">Login</button>
                <p id="loginMessage"></p>
            </div>
        </section>

        <div class="physical-container" style="margin-left: 150px;">
            <div class="travel-planner">
                <h2>Travel Planner</h2>
                <p>Origin: <input></p>
                <p>Destination: <input></p>
                <button>Change routes</button>
            </div>
            
        </div>
       
        
      




    </body>
    <script>
        document.getElementById("loginButton").addEventListener("click", async () =>{
            const username = document.getElementById("loginEmail").value;
            const password = document.getElementById("loginPassword").value;

            if (!username){
                document.getElementById("loginMessage").innerHTML = "Please enter an email address"
                return;
            }
            else if(!password){
                document.getElementById("loginMessage").innerHTML = "Please enter a password"
                return;
            }
            try {
                console.log(username)
                console.log(password)
                const response = await fetch("http://localhost:3000/login", {
                    method: "POST",
                    headers: { "Content-Type": "application/json"},
                    body: JSON.stringify({username,password})
                });

                const result = await response.json();
                if(response.ok){
                    document.getElementById("loginMessage").innerHTML = "Login successfull!";
                }
                else{
                    document.getElementById("loginMessage").innerHTML = result.error || "Login Failed";
                }
            }
            catch{
                document.getElementById("loginMessage").innerHTML = "Login error";
            }
            document.getElementById("loginEmail").value = "";
            document.getElementById("loginPassword").value = "";
            console.log("hi");
        });

        document.getElementById("registrationButton").addEventListener("click", async () =>{
            const username = document.getElementById("userRegistration").value;
            const name = document.getElementById("nameRegistration").value;
            const email = document.getElementById("emailRegistration").value;
            const password = document.getElementById("passwordRegistration").value;
            const passConfirmation = document.getElementById("passwordConfirmation").value;

            if (!email){
                document.getElementById("regMsg").innerHTML = "Please enter an email address"
                return;
            }
            if(!password){
                document.getElementById("regMsg").innerHTML = "Please enter a password"
                return;
            }
            if(!name){
                document.getElementById("regMsg").innerHTML = "Please enter a Name"
                return;
            }
            if(!passConfirmation){
                document.getElementById("regMsg").innerHTML = "Please re-enter a password"
                return;
            }
            if(!username){
                document.getElementById("regMsg").innerHTML = "Please enter a username"
                return;
            }

            if(password != passConfirmation){
                document.getElementById("regMsg").innerHTML = "Passwords Do not Match"
                return;
            }
            try {
                const response = await fetch("http://localhost:3000/createUser", {
                    method: "POST",
                    headers: { "Content-Type": "application/json"},
                    body: JSON.stringify({username,password,email,name})
                });
                let result;
                try{
                    result = await response.json();
                }
                catch{
                    document.getElementById("regMsg").innerHTML = "Server Issue please again letter";
                }
                if(response.ok){
                    document.getElementById("regMsg").innerHTML = "Registration Successful!";
                }
                else{
                    document.getElementById("regMsg").innerHTML = result.error || "Registration Failed";
                }
            }
            catch{
                document.getElementById("regMsg").innerHTML = result.error || "Registration Failed";
            }
        });
    </script>
</html>